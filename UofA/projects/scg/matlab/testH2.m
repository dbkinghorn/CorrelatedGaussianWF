% Do an H2 wf optimization in a basis of shifted correlated Gaussians



Mass = [5.446170e-4 2.723085077e-4 2.723085077e-4;
        2.723085077e-4 .5002723085 2.723085077e-4;
        2.723085077e-4 2.723085077e-4 .5002723085];

Charge = [1 -1 -1 -1 1 -1]';

% symmetry projection terms

% (1)(2)(3)
Sym(:,:,1) = [1 0 0;0 1 0;0 0 1];
% (12)
Sym(:,:,2) = [-1 0 0;-1 1 0;-1 0 1];
% (34)
Sym(:,:,3) = [1 0 0;0 0 1;0 1 0];
% (12)(34)
Sym(:,:,4) = [-1 0 0;-1 0 1;-1 1 0];

% coeff's
symc = [1 1 1 1]';

n=3;
nb=8;

xa1=[   2.096987960357948     
  -1.4745590076490872E-002
  -4.0448949282539136E-002
  -0.5959614784515522     
  -2.1272590975811526E-002
   0.3407640037381904     
    2.358741706350877     
  -2.2907459347190639E-002
  -0.4151828576982308     
   0.6031074480099252     
   2.4909372978454469E-002
   0.8904785905614009     
    2.182257295338354     
  -7.1783052186537646E-002
  -2.0226411158069422E-002
   0.4825596469018524     
   4.0210406718897689E-002
    4.439068420215873     
    2.153648606778568     
  -5.5589581772098988E-002
  -3.1308598903407051E-002
    1.575235879429637     
  -9.1087201525585169E-003
   0.3424121340204002     
    2.968066243865629     
  -3.8824446745586326E-003
   -1.390060254981494     
   0.9757838718510840     
   1.2028070433862373E-002
    1.503777720458265     
    2.384772699564069     
  -0.1445010048017932     
  -0.2699537042432744     
   0.4936593078055128     
   6.3339216680019697E-002
   0.8427269927893906     
    2.145156439168398     
  -5.4790359439419525E-002
  -2.8111895841238421E-002
    1.057051661172330     
  -0.9525063892818432     
   0.8581076631564966     
    2.222761347491723     
  -1.4800726432527759E-002
  -3.9708932948086133E-002
   0.8244326913491374     
   0.3274759120446375     
    1.892759173514089  ];

xa2=[  2.45180975635426
  -0.09584268083150
  -0.02800785088783
   0.62865981212038
   0.03265497919186
   0.35928981488325
   2.16892350391331
  -0.18781618718768
   0.01785832138657
   0.62183450225682
   0.08334571703172
   1.03460314924664
   2.73597425890263
  -0.04418592202317
  -0.82033126290543
  -0.50931900178887
  -0.02505659802882
   1.26001044379431
  -3.00427464522614
   0.05788381637198
   0.05186801772410
  -0.44726881389096
  -0.02801840034005
   2.16787259160856 ];

xs = zeros(36,1);
xs = xs+1e-50;
%xs = randn(18,1)/100;
%xs(1:3)=2.5;
%xs(10:12)=5.0;
%xs(19:21)=10.0;
%xs(28:30)=15.0;
xs=[ 9.87889659858255
   9.81256259786042
   9.81254352720526
  -0.01001236844570
  -0.00967893274275
  -0.00914679652881
   0.00183350922787
   0.00225341499419
   0.00222746848494
   6.96065946806229
   6.95976684411146
   6.95972791887355
  -0.00425994279349
  -0.00574373760860
  -0.00719936731656
   0.11067820953405
   0.10999888054038
   0.10952196885238
   8.45177994864977
   8.45057815290789
   8.45056616710428
   0.00640722949673
   0.00624962505966
   0.00629091748067
  -0.02787601033101
  -0.02897225063240
  -0.02923394228794
  14.54439400393889
  14.54388275856826
  14.54386323295100
  -0.11272800210469
  -0.11305214124514
  -0.11376441416475
   0.00986157857502
   0.00980498306106
   0.00978014304443];

%xc = [ 0.2867173431731412     
%  -2.3748482691514819E-006];

xc1=[ 0.1913583743752103     
   0.1334733410808242     
   1.3239990466636100E-002
   6.6675096197429673E-002
   2.8590160282574034E-002
   9.2355012655283092E-002
  -1.9363342142062208E-002
   1.6396579417535726E-002 ];

xc2=[  2.28995314028635
   0.99300494065171
   0.75868625642310
   0.29213100933489 ];

%xc = [.1 .1 .1 .1]';
%x = [xa' xs' xc']';
xs1=[xs', -xs']';

x1 = [xa1' xs1' xc1']';
%x2 = [xa2' xs' xc2']';

energyrc(x1,n,nb,Mass,Charge,Sym,symc)
options(1)=1;
fminu('energyrc',x1,options,[],n,nb,Mass,Charge,Sym,symc)
